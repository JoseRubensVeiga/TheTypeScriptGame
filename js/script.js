!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=function(){function e(){this.observers=[]}return e.prototype.addObserver=function(e){this.observers.push(e)},e.prototype.emit=function(e){this.observers.forEach((function(t){return t.notify(e)}))},e.prototype.getObservers=function(){return this.observers},e}(),o=function(){function e(){this.keyboardObservable=new n;var e=this.keyboardObservable;window.addEventListener("keydown",(function(t){e.emit(t.key)}))}return e.prototype.getObservable=function(){return this.keyboardObservable},e}(),i=function(){function e(e){this.notifyFn=e}return e.prototype.notify=function(e){this.notifyFn(e)},e}(),s=function(){function e(e,t,r){var n;this.keys=((n={})[r.up]={rows:-1},n[r.right]={columns:1},n[r.down]={rows:1},n[r.left]={columns:-1},n),this.player=document.createElement("div"),this.player.classList.add("player"),this.player.style.gridColumn=this.validateRow(t).toString(),this.player.style.gridRow=this.validateColumn(e).toString(),this.setPlayerObserver(),this.subscribeKeyboardListener()}return e.prototype.setPlayerObserver=function(){var e=this;this.observer=new i((function(t){var r=e.getKeys();r[t]&&e.move(r[t])}))},e.prototype.getPlayerObserver=function(){return this.observer},e.prototype.subscribeKeyboardListener=function(){(new o).getObservable().addObserver(this.getPlayerObserver())},e.prototype.validateColumn=function(e){return e<=0?1:e<=15?e:15},e.prototype.validateRow=function(e){return e<=0?1:e<=15?e:15},e.prototype.getElement=function(){return this.player},e.prototype.getKeys=function(){return this.keys},e.prototype.move=function(e){var t=parseInt(this.player.style.getPropertyValue("grid-row").split(" ")[0]),r=parseInt(this.player.style.getPropertyValue("grid-column").split(" ")[0]),n=t+(e.rows||0),o=r+(e.columns||0);this.player.style.gridRow=""+this.validateRow(n),this.player.style.gridColumn=""+this.validateColumn(o)},e}(),u=function(e){this.element=document.getElementById(e)},a=new(function(){function e(){var e=new u("app");this.app=e.element,this.createGame()}return e.prototype.createGame=function(){return this.app.classList.add("game-container"),this.app.style.gridTemplateRows="repeat(15, 1fr)",this.app.style.gridTemplateColumns="repeat(15, 1fr)",e},e.prototype.registerPlayer=function(e){e instanceof s&&(e=e.getElement()),this.app.appendChild(e)},e}()),l=new s(3,5,{up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",left:"ArrowLeft"}),p=new s(2,6,{up:"w",right:"d",down:"s",left:"a"});a.registerPlayer(l),a.registerPlayer(p)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vYXBwL09ic2VydmFibGUudHMiLCJ3ZWJwYWNrOi8vLy4vYXBwL0tleUJvYXJkTGlzdGVuZXIudHMiLCJ3ZWJwYWNrOi8vLy4vYXBwL09ic2VydmVyLnRzIiwid2VicGFjazovLy8uL2FwcC9QbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vYXBwL2Vudmlyb21lbnQudHMiLCJ3ZWJwYWNrOi8vLy4vYXBwL0VsZW1lbnRSZWYudHMiLCJ3ZWJwYWNrOi8vLy4vYXBwL2FwcC50cyIsIndlYnBhY2s6Ly8vLi9hcHAvR2FtZS50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIm9ic2VydmVycyIsImFkZE9ic2VydmVyIiwib2JzZXJ2ZXIiLCJ0aGlzIiwicHVzaCIsImVtaXQiLCJhcmciLCJmb3JFYWNoIiwibm90aWZ5IiwiZ2V0T2JzZXJ2ZXJzIiwia2V5Ym9hcmRPYnNlcnZhYmxlIiwiT2JzZXJ2YWJsZSIsIl9rZXlib2FyZE9ic2VydmFibGUiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImdldE9ic2VydmFibGUiLCJub3RpZnlGbiIsImRhdGEiLCJjb2x1bW4iLCJyb3ciLCJwbGF5ZXJLZXlzIiwia2V5cyIsInVwIiwicm93cyIsInJpZ2h0IiwiY29sdW1ucyIsImRvd24iLCJsZWZ0IiwicGxheWVyIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic3R5bGUiLCJncmlkQ29sdW1uIiwidmFsaWRhdGVSb3ciLCJ0b1N0cmluZyIsImdyaWRSb3ciLCJ2YWxpZGF0ZUNvbHVtbiIsInNldFBsYXllck9ic2VydmVyIiwic3Vic2NyaWJlS2V5Ym9hcmRMaXN0ZW5lciIsIk9ic2VydmVyIiwiYXJncyIsImdldEtleXMiLCJtb3ZlIiwiZ2V0UGxheWVyT2JzZXJ2ZXIiLCJnZXRFbGVtZW50IiwicGFyc2VJbnQiLCJnZXRQcm9wZXJ0eVZhbHVlIiwic3BsaXQiLCJuZXdSb3ciLCJuZXdDb2x1bW4iLCJlbGVtZW50SWQiLCJlbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnYW1lIiwiZWxlbWVudFJlZiIsIkVsZW1lbnRSZWYiLCJhcHAiLCJjcmVhdGVHYW1lIiwiZ3JpZFRlbXBsYXRlUm93cyIsImdyaWRUZW1wbGF0ZUNvbHVtbnMiLCJHYW1lIiwicmVnaXN0ZXJQbGF5ZXIiLCJhcHBlbmRDaGlsZCIsInBsYXllcjEiLCJwbGF5ZXIyIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNT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a0JBQ2xDMUQsS0FBS3dELElBQUl6QixNQUFNNEIsb0JBQXNCLGtCQUU5QkMsR0FHWCxZQUFBQyxlQUFBLFNBQWVuQyxHQUVSQSxhQUFrQixJQUNqQkEsRUFBU0EsRUFBT2tCLGNBRXBCNUMsS0FBS3dELElBQUlNLFlBQVlwQyxJQUU3QixFQTFCQSxJRENNcUMsRUFBVSxJQUFJLEVBQU8sRUFBRyxFQUFHLENBQzdCM0MsR0FBSSxVQUNKRSxNQUFPLGFBQ1BFLEtBQU0sWUFDTkMsS0FBTSxjQUdKdUMsRUFBVSxJQUFJLEVBQU8sRUFBRyxFQUFHLENBQzdCNUMsR0FBSSxJQUNKRSxNQUFPLElBQ1BFLEtBQU0sSUFDTkMsS0FBTSxNQUdWNEIsRUFBS1EsZUFBZUUsR0FDcEJWLEVBQUtRLGVBQWVHIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IE9ic2VydmVyIH0gZnJvbSAnLi9PYnNlcnZlcic7XHJcblxyXG5leHBvcnQgY2xhc3MgT2JzZXJ2YWJsZSB7XHJcbiAgICBwcml2YXRlIG9ic2VydmVyczogYW55W10gPSBbXTtcclxuXHJcbiAgICBhZGRPYnNlcnZlcihvYnNlcnZlcjogT2JzZXJ2ZXIpIDogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7XHJcbiAgICB9XHJcblxyXG4gICAgZW1pdChhcmc6IGFueVtdIHwge30pIHtcclxuICAgICAgICB0aGlzLm9ic2VydmVycy5mb3JFYWNoKCAob2JzZXJ2ZXIgOiBPYnNlcnZlcikgPT4gb2JzZXJ2ZXIubm90aWZ5KGFyZykpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldE9ic2VydmVycygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZlcnM7XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwiLi9PYnNlcnZhYmxlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgS2V5Ym9hcmRMaXN0ZW5lciB7XHJcbiAgICBwcml2YXRlIGtleWJvYXJkT2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlKCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgY29uc3QgX2tleWJvYXJkT2JzZXJ2YWJsZSA9IHRoaXMua2V5Ym9hcmRPYnNlcnZhYmxlO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIF9rZXlib2FyZE9ic2VydmFibGUuZW1pdChlLmtleSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0T2JzZXJ2YWJsZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5rZXlib2FyZE9ic2VydmFibGU7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgT2JzZXJ2ZXIge1xyXG4gICAgbm90aWZ5Rm46IEZ1bmN0aW9uO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG5vdGlmeUZuOiBGdW5jdGlvbikge1xyXG4gICAgICAgIHRoaXMubm90aWZ5Rm4gPSBub3RpZnlGbjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgbm90aWZ5KGRhdGE6IGFueVtdIHwge30pIHtcclxuICAgICAgICB0aGlzLm5vdGlmeUZuKGRhdGEpO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IEtleWJvYXJkTGlzdGVuZXIgfSBmcm9tICcuL0tleUJvYXJkTGlzdGVuZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZlciB9IGZyb20gJy4vT2JzZXJ2ZXInO1xyXG5pbXBvcnQgeyBNb3ZlUGxheWVyIH0gZnJvbSAnLi9pbnRlcmZhY2VzL01vdmVQbGF5ZXIuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgS2V5Ym9hcmRLZXlzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL0tleWJvYXJkS2V5cy5pbnRlcmZhY2UnO1xyXG5cclxuaW1wb3J0IHsgR0FNRV9DT0xVTU5TLCBHQU1FX1JPV1MgfSBmcm9tICcuL2Vudmlyb21lbnQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBsYXllciB7XHJcbiAgICBrZXlzOiBhbnk7XHJcbiAgICBwbGF5ZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgb2JzZXJ2ZXI6IE9ic2VydmVyO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbHVtbjogbnVtYmVyLCByb3c6IG51bWJlciwgcGxheWVyS2V5czogS2V5Ym9hcmRLZXlzKSB7XHJcbiAgICAgICAgdGhpcy5rZXlzID0ge1xyXG4gICAgICAgICAgICBbcGxheWVyS2V5cy51cF06IHtyb3dzOiAtMX0sXHJcbiAgICAgICAgICAgIFtwbGF5ZXJLZXlzLnJpZ2h0XToge2NvbHVtbnM6IDF9LFxyXG4gICAgICAgICAgICBbcGxheWVyS2V5cy5kb3duXToge3Jvd3M6IDF9LFxyXG4gICAgICAgICAgICBbcGxheWVyS2V5cy5sZWZ0XToge2NvbHVtbnM6IC0xfSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLnBsYXllciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHRoaXMucGxheWVyLmNsYXNzTGlzdC5hZGQoJ3BsYXllcicpO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXllci5zdHlsZS5ncmlkQ29sdW1uID0gdGhpcy52YWxpZGF0ZVJvdyhyb3cpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuc3R5bGUuZ3JpZFJvdyA9IHRoaXMudmFsaWRhdGVDb2x1bW4oY29sdW1uKS50b1N0cmluZygpO1xyXG5cclxuICAgICAgICB0aGlzLnNldFBsYXllck9ic2VydmVyKCk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVLZXlib2FyZExpc3RlbmVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0UGxheWVyT2JzZXJ2ZXIoKSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlciA9IG5ldyBPYnNlcnZlcigoYXJnczogYW55KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGtleXMgPSB0aGlzLmdldEtleXMoKTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgaWYoa2V5c1thcmdzXSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlKGtleXNbYXJnc10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBnZXRQbGF5ZXJPYnNlcnZlcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZlcjtcclxuICAgIH07XHJcblxyXG4gICAgc3Vic2NyaWJlS2V5Ym9hcmRMaXN0ZW5lcigpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBrZXlib2FyZExpc3RlbmVyID0gbmV3IEtleWJvYXJkTGlzdGVuZXIoKVxyXG4gICAgICAgIGtleWJvYXJkTGlzdGVuZXIuZ2V0T2JzZXJ2YWJsZSgpLmFkZE9ic2VydmVyKHRoaXMuZ2V0UGxheWVyT2JzZXJ2ZXIoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGVDb2x1bW4oY29sdW1uOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiAoY29sdW1uIDw9IDApID8gMSA6ICgoY29sdW1uIDw9IEdBTUVfQ09MVU1OUyApID8gY29sdW1uIDogR0FNRV9DT0xVTU5TKTtcclxuICAgIH1cclxuXHJcbiAgICB2YWxpZGF0ZVJvdyhyb3c6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIChyb3cgPD0gMCkgPyAxIDogKChyb3cgPD0gR0FNRV9ST1dTICkgPyByb3cgOiBHQU1FX1JPV1MpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEVsZW1lbnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGxheWVyO1xyXG4gICAgfTtcclxuXHJcbiAgICBnZXRLZXlzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmtleXM7XHJcbiAgICB9O1xyXG5cclxuICAgIG1vdmUobW92ZTogTW92ZVBsYXllcikge1xyXG4gICAgICAgIGNvbnN0IHJvdyA9IHBhcnNlSW50KHRoaXMucGxheWVyLnN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2dyaWQtcm93Jykuc3BsaXQoXCIgXCIpWzBdKTtcclxuICAgICAgICBjb25zdCBjb2x1bW4gPSBwYXJzZUludCh0aGlzLnBsYXllci5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdncmlkLWNvbHVtbicpLnNwbGl0KFwiIFwiKVswXSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG5ld1JvdyA9IHJvdyArIChtb3ZlLnJvd3MgfHwgMCk7XHJcbiAgICAgICAgY29uc3QgbmV3Q29sdW1uID0gY29sdW1uICsgKG1vdmUuY29sdW1ucyB8fCAwKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuc3R5bGUuZ3JpZFJvdyA9IGAke3RoaXMudmFsaWRhdGVSb3cobmV3Um93KX1gO1xyXG4gICAgICAgIHRoaXMucGxheWVyLnN0eWxlLmdyaWRDb2x1bW4gPSBgJHt0aGlzLnZhbGlkYXRlQ29sdW1uKG5ld0NvbHVtbil9YDtcclxuICAgIH07XHJcbn1cclxuXHJcbiIsIlxyXG5leHBvcnQgY29uc3QgR0FNRV9DT0xVTU5TID0gMTU7XHJcbmV4cG9ydCBjb25zdCBHQU1FX1JPV1MgPSAxNTsiLCJleHBvcnQgY2xhc3MgRWxlbWVudFJlZiB7XHJcbiAgICBwdWJsaWMgZWxlbWVudDogSFRNTEVsZW1lbnQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoZWxlbWVudElkOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlbGVtZW50SWQpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSAnLi9QbGF5ZXInO1xyXG5pbXBvcnQgeyBHYW1lIH0gZnJvbSAnLi9HYW1lJztcclxuXHJcbmNvbnN0IGdhbWUgPSBuZXcgR2FtZSgpO1xyXG5cclxuY29uc3QgcGxheWVyMSA9IG5ldyBQbGF5ZXIoMywgNSwge1xyXG4gICAgdXA6ICdBcnJvd1VwJyxcclxuICAgIHJpZ2h0OiAnQXJyb3dSaWdodCcsXHJcbiAgICBkb3duOiAnQXJyb3dEb3duJyxcclxuICAgIGxlZnQ6ICdBcnJvd0xlZnQnLFxyXG59KTtcclxuXHJcbmNvbnN0IHBsYXllcjIgPSBuZXcgUGxheWVyKDIsIDYsIHtcclxuICAgIHVwOiAndycsXHJcbiAgICByaWdodDogJ2QnLFxyXG4gICAgZG93bjogJ3MnLFxyXG4gICAgbGVmdDogJ2EnLFxyXG59KTtcclxuXHJcbmdhbWUucmVnaXN0ZXJQbGF5ZXIocGxheWVyMSk7XHJcbmdhbWUucmVnaXN0ZXJQbGF5ZXIocGxheWVyMik7XHJcblxyXG5cclxuIiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSAnLi9QbGF5ZXInO1xyXG5pbXBvcnQgeyBFbGVtZW50UmVmIH0gZnJvbSAnLi9FbGVtZW50UmVmJztcclxuaW1wb3J0IHsgR0FNRV9ST1dTLCBHQU1FX0NPTFVNTlMgfSBmcm9tICcuL2Vudmlyb21lbnQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWUge1xyXG4gICAgYXBwOiBIVE1MRWxlbWVudDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBjb25zdCBlbGVtZW50UmVmID0gbmV3IEVsZW1lbnRSZWYoJ2FwcCcpO1xyXG4gICAgICAgIHRoaXMuYXBwID0gZWxlbWVudFJlZi5lbGVtZW50O1xyXG5cclxuICAgICAgICB0aGlzLmNyZWF0ZUdhbWUoKTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVHYW1lKCkge1xyXG5cclxuICAgICAgICB0aGlzLmFwcC5jbGFzc0xpc3QuYWRkKCdnYW1lLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIHRoaXMuYXBwLnN0eWxlLmdyaWRUZW1wbGF0ZVJvd3MgPSBgcmVwZWF0KCR7R0FNRV9ST1dTfSwgMWZyKWA7XHJcbiAgICAgICAgdGhpcy5hcHAuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoJHtHQU1FX0NPTFVNTlN9LCAxZnIpYDtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gR2FtZTtcclxuICAgIH1cclxuXHJcbiAgICByZWdpc3RlclBsYXllcihwbGF5ZXI6IGFueSkge1xyXG5cclxuICAgICAgICBpZihwbGF5ZXIgaW5zdGFuY2VvZiBQbGF5ZXIpIHtcclxuICAgICAgICAgICAgcGxheWVyID0gcGxheWVyLmdldEVsZW1lbnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hcHAuYXBwZW5kQ2hpbGQocGxheWVyKTtcclxuICAgIH1cclxufTtcclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=